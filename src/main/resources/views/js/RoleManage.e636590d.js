(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["RoleManage"],{a32f:function(e,t,i){"use strict";function n(e){var t=[];e.map(function(e){"0"===e.parentId&&t.push(e)});for(var i=function(i){var n=t[i];n.list=[],e.map(function(e){e.parentId===n.menuId&&n.list.push(e)});for(var a=function(t,i){n.list[t].list=[],e.map(function(e){e.parentId===n.list[t].menuId&&n.list[t].list.push(e)});for(var a=function(i,a){n.list[t].list[i].list=[],e.map(function(e){e.parentId===n.list[t].list[i].menuId&&n.list[t].list[i].list.push(e)})},r=0,l=n.list[t].list.length;r<l;r++)a(r,l)},r=0,l=n.list.length;r<l;r++)a(r,l)},n=0;n<t.length;n++)i(n);return t}i.d(t,"a",function(){return n})},c874:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[e.isShowList?i("div",[i("div",{staticClass:"filter-container"},[i("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter(t)}},model:{value:e.listQuery.roleName,callback:function(t){e.$set(e.listQuery,"roleName",t)},expression:"listQuery.roleName"}}),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"2px"},attrs:{icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("\n        "+e._s(e.$t("common.search"))+"\n      ")]),i("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v("\n        "+e._s(e.$t("common.create"))+"\n      ")]),i("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleEdit}},[e._v("\n        "+e._s(e.$t("common.edit"))+"\n      ")]),i("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.handleDelete}},[e._v("\n        "+e._s(e.$t("common.delete"))+"\n      ")])],1),i("table-list",{attrs:{data:e.list,columns:e.columns,"row-key":e.idKey},on:{handleSortChange:e.handleSortChange,handleSelectionChange:e.handleSelectionChange}}),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:e.getList}})],1):i("div",[i("el-tabs",{attrs:{type:"border-card"}},[i("el-tab-pane",{attrs:{label:e.tabLabel}},[i("edit",{attrs:{id:e.id,type:e.type},on:{"msg-from-child":e.getMsgFromChild}})],1)],1)],1)])},a=[],r=i("b0b4"),l=i("d225"),s=i("308d"),o=i("6bb5"),c=i("4e2b"),u=i("9ab4"),m=i("60a3"),d=i("0bfbe"),h=i("333d"),f=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[i("el-input",{model:{value:e.ruleForm.roleName,callback:function(t){e.$set(e.ruleForm,"roleName",t)},expression:"ruleForm.roleName"}})],1),i("el-form-item",{attrs:{label:"备注"}},[i("el-input",{model:{value:e.ruleForm.remark,callback:function(t){e.$set(e.ruleForm,"remark",t)},expression:"ruleForm.remark"}})],1),i("el-form-item",{attrs:{label:"授权"}},[i("el-tree",{ref:"tree",attrs:{data:e.treeData,props:e.defaultProps,"check-strictly":!0,"show-checkbox":"","node-key":"menuId"}})],1),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("\n        "+e._s(e.$t("common.comfirm"))+"\n      ")]),i("el-button",{on:{click:e.cancel}},[e._v("\n        "+e._s(e.$t("common.cancel"))+"\n      ")])],1)],1)],1)},p=[],y=i("b32d");function b(e){return Object(y["a"])({url:"/sys/role/list",method:"get",params:e})}function v(){return Object(y["a"])({url:"/sys/menu/list",method:"get"})}function g(e){var t="/sys/role/info/"+e;return Object(y["a"])({url:t,method:"get"})}function k(e){return Object(y["a"])({url:"sys/role/save",method:"post",data:e})}function O(e){return Object(y["a"])({url:"sys/role/update",method:"put",data:e})}function j(e){return Object(y["a"])({url:"/sys/role/delete",method:"delete",data:e})}var w=function(){function e(){Object(l["a"])(this,e),this.roleId="",this.roleName="",this.createTime="",this.createUserId=0,this.menuIdList=[],this.remark=""}return Object(r["a"])(e,null,[{key:"build",value:function(t){var i=new e;return i.roleId=t.roleId,i.roleName=t.roleName,i.createTime=t.createTime,i.createUserId=t.createUserId,i.menuIdList=t.menuIdList,i.remark=t.remark,i}}]),e}(),C=i("a32f"),F=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(s["a"])(this,Object(o["a"])(t).apply(this,arguments)),e.ruleForm=new w,e.rules={roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:3,max:16,message:"长度在 3 到 16 个字符",trigger:"blur"}],roleIdList:[{type:"array",required:!0,message:"请至少选择一个角色",trigger:"change"}]},e.defaultProps={children:"list",label:"name"},e.treeData=[],e}return Object(c["a"])(t,e),Object(r["a"])(t,[{key:"created",value:function(){"edit"===this.type&&this.getEditInfo(),this.getMenuList()}},{key:"submitForm",value:function(e){var t=this,i=this.$refs[e];i.validate(function(e){if(!e)return console.log("error submit!!"),!1;"edit"===t.type?t.handleEdit():t.handleSubmit()})}},{key:"handleSubmit",value:function(){var e=this,t=this.$refs.tree.getCheckedKeys(),i=this.$refs.tree.getHalfCheckedKeys();this.ruleForm.menuIdList=t.concat(i),k(this.ruleForm).then(function(t){e.$emit("msg-from-child",e.type)})}},{key:"handleEdit",value:function(){var e=this,t=this.$refs.tree.getCheckedKeys(),i=this.$refs.tree.getHalfCheckedKeys();this.ruleForm.menuIdList=t.concat(i),O(this.ruleForm).then(function(t){e.$emit("msg-from-child",e.type)})}},{key:"cancel",value:function(){this.$emit("msg-from-child","cancel")}},{key:"getMenuList",value:function(){var e=this;v().then(function(t){e.treeData=Object(C["a"])(t.menuList)})}},{key:"getEditInfo",value:function(){var e=this;g(this.id).then(function(t){var i=t.role;e.ruleForm=w.build(i);var n=e.$refs.tree;n.setCheckedKeys(i.menuIdList)}).catch(function(e){console.log(e)})}}]),t}(m["c"]);u["a"]([Object(m["b"])()],F.prototype,"id",void 0),u["a"]([Object(m["b"])({default:"save"})],F.prototype,"type",void 0),F=u["a"]([Object(m["a"])({name:"RoleEdit"})],F);var I=F,$=I,L=i("2877"),S=Object(L["a"])($,f,p,!1,null,null,null),_=S.exports,x=i("27cf"),N=i("1162"),Q=i("c119"),E=i("c0c7"),K=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(s["a"])(this,Object(o["a"])(t).apply(this,arguments)),e.roleName="",e}return Object(c["a"])(t,e),t}(x["a"]),T=(N["a"],function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(s["a"])(this,Object(o["a"])(t).apply(this,arguments)),e.isShowList=!0,e.listQuery=new K,e.list=[],e.newList=[],e.columns=[{label:"角色ID",key:"roleId",width:200},{label:"角色名称",key:"roleName"},{label:"备注",key:"remark"},{label:"创建时间",key:"createTime",width:150}],e.total=0,e.type="",e.id="0",e.multipleSelection=[],e.idKey="roleId",e}return Object(c["a"])(t,e),Object(r["a"])(t,[{key:"created",value:function(){this.getList()}},{key:"getList",value:function(){var e=this;b(this.listQuery).then(function(t){var i=t.page;e.list=i.list,e.total=i.totalCount,e.newList=e.list.map(function(t){return t[e.idKey]});var n=document.querySelectorAll(".el-table__body-wrapper > table > tbody")[0];Object(E["a"])(n,e.list,e.newList)})}},{key:"handleFilter",value:function(){this.listQuery._search=!0,this.listQuery.page=1,this.getList()}},{key:"handleCreate",value:function(){this.type="save",this.isShowList=!1}},{key:"handleEdit",value:function(){var e=this;Object(Q["a"])(this.multipleSelection,"one").then(function(){e.id=e.multipleSelection[0][e.idKey],e.type="edit",e.isShowList=!1})}},{key:"handleDelete",value:function(){var e=this;Object(Q["a"])(this.multipleSelection).then(function(){e.$confirm("是否确定删除该数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=[];e.multipleSelection.map(function(i){t.push(i[e.idKey])}),j(t).then(function(t){e.$message({type:"success",message:"删除成功!"}),e.handleFilter()})}).catch(function(){})})}},{key:"handleSortChange",value:function(e){void 0!==e.sidx&&(this.listQuery.sidx=e.sidx),this.listQuery.order=e.order,this.handleFilter()}},{key:"handleSelectionChange",value:function(e){this.multipleSelection=e}},{key:"getMsgFromChild",value:function(e){"cancel"!==e&&this.handleFilter(),this.isShowList=!0}},{key:"tabLabel",get:function(){return"edit"===this.type?this.$t("common.edit"):this.$t("common.create")}}]),t}(m["c"]));T=u["a"]([Object(m["a"])({name:"RoleManage",components:{TableList:d["a"],Pagination:h["a"],Edit:_}})],T);var D=T,M=D,q=Object(L["a"])(M,n,a,!1,null,null,null);t["default"]=q.exports}}]);
//# sourceMappingURL=RoleManage.e636590d.js.map