(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ScheduleManage"],{fb43:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[e.isShowList?a("div",[a("div",{staticClass:"filter-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter(t)}},model:{value:e.listQuery.beanName,callback:function(t){e.$set(e.listQuery,"beanName",t)},expression:"listQuery.beanName"}}),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"2px"},attrs:{icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("\n        "+e._s(e.$t("common.search"))+"\n      ")]),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v("\n        "+e._s(e.$t("common.create"))+"\n      ")]),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleEdit}},[e._v("\n        "+e._s(e.$t("common.edit"))+"\n      ")]),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.handleDelete}},[e._v("\n        "+e._s(e.$t("common.delete"))+"\n      ")]),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"danger",icon:"el-icon-pause"},on:{click:e.handlePause}},[e._v("\n        暂停\n      ")]),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"success",icon:"el-icon-play"},on:{click:e.handleResume}},[e._v("\n        开始\n      ")])],1),a("table-list",{attrs:{data:e.list,columns:e.columns,"row-key":e.idKey},on:{handleSortChange:e.handleSortChange,handleSelectionChange:e.handleSelectionChange},scopedSlots:e._u([{key:"status",fn:function(t){return[a("el-tag",{attrs:{type:e._f("statusFilter")(t.row.status)}},[e._v("\n          "+e._s(e._f("statusTextFilter")(t.row.status))+"\n        ")])]}}],null,!1,1440214634)}),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:e.getList}})],1):a("div",[a("el-tabs",{attrs:{type:"border-card"}},[a("el-tab-pane",{attrs:{label:e.tabLabel}},[a("edit",{attrs:{id:e.id,type:e.type},on:{"msg-from-child":e.getMsgFromChild}})],1)],1)],1)])},i=[],l=a("b0b4"),s=a("d225"),r=a("308d"),o=a("6bb5"),c=a("4e2b"),u=a("9ab4"),m=a("60a3"),d=a("0bfbe"),h=a("333d"),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"bean名称"}},[a("el-input",{attrs:{placeholder:"spring bean名称，如：testTask"},model:{value:e.ruleForm.beanName,callback:function(t){e.$set(e.ruleForm,"beanName",t)},expression:"ruleForm.beanName"}}),a("font",{attrs:{color:"red"}},[a("b",[e._v("Spring容器中必须存在该对象")])])],1),a("el-form-item",{attrs:{label:"方法名称"}},[a("el-input",{attrs:{placeholder:"方法名称"},model:{value:e.ruleForm.methodName,callback:function(t){e.$set(e.ruleForm,"methodName",t)},expression:"ruleForm.methodName"}}),a("font",{attrs:{color:"red"}},[a("b",[e._v("指定的Bean中必须有这个方法")])])],1),a("el-form-item",{attrs:{label:"参数"}},[a("el-input",{attrs:{placeholder:"参数"},model:{value:e.ruleForm.params,callback:function(t){e.$set(e.ruleForm,"params",t)},expression:"ruleForm.params"}}),a("font",{attrs:{color:"red"}},[a("b",[e._v("方法最多支持一个参数，多个参数通过json格式传参")])])],1),a("el-form-item",{attrs:{label:"cron表达式"}},[a("el-input",{attrs:{placeholder:"如：0 0 12 * * ?"},model:{value:e.ruleForm.cronExpression,callback:function(t){e.$set(e.ruleForm,"cronExpression",t)},expression:"ruleForm.cronExpression"}}),a("font",{attrs:{color:"red"}},[a("b",[e._v("定时执行规则，需懂Cron语法程序员设置")])]),a("br"),a("font",[e._v("秒 分钟 小时 日期 月 星期  年（可选）")])],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{placeholder:"备注"},model:{value:e.ruleForm.remark,callback:function(t){e.$set(e.ruleForm,"remark",t)},expression:"ruleForm.remark"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("\n        "+e._s(e.$t("common.comfirm"))+"\n      ")]),a("el-button",{on:{click:e.cancel}},[e._v("\n        "+e._s(e.$t("common.cancel"))+"\n      ")])],1)],1)],1)},b=[],f=a("b32d");function y(e){return Object(f["a"])({url:"/sys/schedule/list",method:"get",params:e})}function v(e){return Object(f["a"])({url:"/sys/schedule/save",method:"post",data:e})}function g(e){var t="/sys/schedule/info/"+e;return Object(f["a"])({url:t,method:"get"})}function k(e){return Object(f["a"])({url:"/sys/schedule/update",method:"put",data:e})}function j(e){return Object(f["a"])({url:"/sys/schedule/delete",method:"delete",data:e})}function F(e){return Object(f["a"])({url:"/sys/schedule/pause",method:"get",data:e})}function w(e){return Object(f["a"])({url:"/sys/schedule/resume",method:"get",data:e})}var O=function(){function e(){Object(s["a"])(this,e),this.jobId="",this.beanName="",this.methodName="",this.params="",this.cronExpression="",this.createTime="",this.status=0,this.remark=""}return Object(l["a"])(e,null,[{key:"build",value:function(t){var a=new e;return a.jobId=t.jobId,a.beanName=t.beanName,a.methodName=t.methodName,a.params=t.params,a.cronExpression=t.cronExpression,a.createTime=t.createTime,a.status=t.status,a.remark=t.remark,a}}]),e}(),x=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(r["a"])(this,Object(o["a"])(t).apply(this,arguments)),e.ruleForm=new O,e.rules={key:[{required:!0,message:"请输入参数名称",trigger:"blur"}],value:[{required:!0,message:"请输入参数值",trigger:"blur"}]},e}return Object(c["a"])(t,e),Object(l["a"])(t,[{key:"created",value:function(){"edit"===this.type&&this.getEditInfo()}},{key:"submitForm",value:function(e){var t=this,a=this.$refs[e];a.validate(function(e){if(!e)return console.log("error submit!!"),!1;"edit"===t.type?t.handleEdit():t.handleSubmit()})}},{key:"handleSubmit",value:function(){var e=this;v(this.ruleForm).then(function(t){e.$emit("msg-from-child",e.type)})}},{key:"handleEdit",value:function(){var e=this;k(this.ruleForm).then(function(t){e.$emit("msg-from-child",e.type)})}},{key:"cancel",value:function(){this.$emit("msg-from-child","cancel")}},{key:"getEditInfo",value:function(){var e=this;g(this.id).then(function(t){var a=t.schedule;e.ruleForm=O.build(a)}).catch(function(e){console.log(e)})}}]),t}(m["c"]);u["a"]([Object(m["b"])()],x.prototype,"id",void 0),u["a"]([Object(m["b"])({default:"save"})],x.prototype,"type",void 0),x=u["a"]([Object(m["a"])({name:"ScheduleEdit"})],x);var S=x,_=S,$=a("2877"),C=Object($["a"])(_,p,b,!1,null,null,null),N=C.exports,E=a("27cf"),L=a("1162"),Q=a("c119"),T=a("c0c7"),I=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(r["a"])(this,Object(o["a"])(t).apply(this,arguments)),e.beanName="",e}return Object(c["a"])(t,e),t}(E["a"]),B=(L["a"],function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(r["a"])(this,Object(o["a"])(t).apply(this,arguments)),e.isShowList=!0,e.listQuery=new I,e.list=[],e.newList=[],e.columns=[{label:"任务ID",key:"jobId"},{label:"bean名称",key:"beanName"},{label:"方法名称",key:"methodName"},{label:"参数",key:"params"},{label:"cron表达式",key:"cronExpression"},{label:"备注",key:"remark"},{label:"状态",key:"status",slot:"status"}],e.total=0,e.type="",e.id="0",e.multipleSelection=[],e.idKey="jobId",e}return Object(c["a"])(t,e),Object(l["a"])(t,[{key:"created",value:function(){this.getList()}},{key:"getList",value:function(){var e=this;y(this.listQuery).then(function(t){var a=t.page;e.list=a.list,e.total=a.totalCount,e.newList=e.list.map(function(t){return t[e.idKey]});var n=document.querySelectorAll(".el-table__body-wrapper > table > tbody")[0];Object(T["a"])(n,e.list,e.newList)})}},{key:"handleFilter",value:function(){this.listQuery._search=!0,this.listQuery.page=1,this.getList()}},{key:"handleCreate",value:function(){this.type="save",this.isShowList=!1}},{key:"handleEdit",value:function(){var e=this;Object(Q["a"])(this.multipleSelection,"one").then(function(){e.id=e.multipleSelection[0][e.idKey],e.type="edit",e.isShowList=!1})}},{key:"handleDelete",value:function(){var e=this;Object(Q["a"])(this.multipleSelection).then(function(){e.$confirm("是否确定删除该数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=[];e.multipleSelection.map(function(a){t.push(a[e.idKey])}),j(t).then(function(t){e.$message({type:"success",message:"删除成功!"}),e.handleFilter()})}).catch(function(){})})}},{key:"handleSortChange",value:function(e){void 0!==e.sidx&&(this.listQuery.sidx=e.sidx),this.listQuery.order=e.order,this.handleFilter()}},{key:"handleSelectionChange",value:function(e){this.multipleSelection=e}},{key:"getMsgFromChild",value:function(e){"cancel"!==e&&this.handleFilter(),this.isShowList=!0}},{key:"handlePause",value:function(){var e=this;Object(Q["a"])(this.multipleSelection).then(function(){e.$confirm("确定要暂停选中的记录?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.postPauseData()}).catch(function(){})})}},{key:"postPauseData",value:function(){var e=this,t=[];this.multipleSelection.map(function(e){t.push(e.jobId)}),F({jobIds:t}).then(function(t){e.$message({type:"success",message:"暂停成功!"}),e.handleFilter()})}},{key:"handleResume",value:function(){var e=this;Object(Q["a"])(this.multipleSelection).then(function(){e.$confirm("确定要开始选中的记录?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.postResumeData()}).catch(function(){})})}},{key:"postResumeData",value:function(){var e=this,t=[];this.multipleSelection.map(function(e){t.push(e.jobId)}),w({jobIds:t}).then(function(t){e.$message({type:"success",message:"开始成功!"}),e.handleFilter()})}},{key:"tabLabel",get:function(){return"edit"===this.type?this.$t("common.edit"):this.$t("common.create")}}]),t}(m["c"]));B=u["a"]([Object(m["a"])({name:"ScheduleManage",components:{TableList:d["a"],Pagination:h["a"],Edit:N},filters:{statusFilter:function(e){var t=["success","danger"];return t[e]},statusTextFilter:function(e){var t=["正常","暂停"];return t[e]}}})],B);var D=B,K=D,P=Object($["a"])(K,n,i,!1,null,null,null);t["default"]=P.exports}}]);
//# sourceMappingURL=ScheduleManage.de03679d.js.map