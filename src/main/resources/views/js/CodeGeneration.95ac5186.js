(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["CodeGeneration"],{"7af1":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",[a("div",{staticClass:"filter-container"},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.configForm,rules:e.rules,inline:"","label-width":"100px"}},[a("el-form-item",{attrs:{prop:"jdbcUrl"}},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"数据库ip地址:必填"},model:{value:e.configForm.jdbcUrl,callback:function(t){e.$set(e.configForm,"jdbcUrl",t)},expression:"configForm.jdbcUrl"}})],1),a("el-form-item",{attrs:{prop:"port"}},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"数据库端口:3306"},model:{value:e.configForm.port,callback:function(t){e.$set(e.configForm,"port",t)},expression:"configForm.port"}})],1),a("el-form-item",{attrs:{prop:"database"}},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"数据库名称:必填"},model:{value:e.configForm.database,callback:function(t){e.$set(e.configForm,"database",t)},expression:"configForm.database"}})],1),a("el-form-item",{attrs:{prop:"username"}},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"用户名:必填"},model:{value:e.configForm.username,callback:function(t){e.$set(e.configForm,"username",t)},expression:"configForm.username"}})],1),a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"密码:必填"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getDatasource(t)}},model:{value:e.configForm.password,callback:function(t){e.$set(e.configForm,"password",t)},expression:"configForm.password"}})],1),a("el-form-item",[a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"danger",icon:"el-icon-edit"},on:{click:e.getDatasource}},[e._v("\n            初始化数据库\n          ")])],1)],1),a("div",[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"表名"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter(t)}},model:{value:e.listQuery.tableName,callback:function(t){e.$set(e.listQuery,"tableName",t)},expression:"listQuery.tableName"}}),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("\n          "+e._s(e.$t("common.search"))+"\n        ")])],1),a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"系统名"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getDatasource(t)}},model:{value:e.downloadInfo.sysName,callback:function(t){e.$set(e.downloadInfo,"sysName",t)},expression:"downloadInfo.sysName"}}),a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px","margin-left":"10px"},attrs:{placeholder:"模块名"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getDatasource(t)}},model:{value:e.downloadInfo.moduleName,callback:function(t){e.$set(e.downloadInfo,"moduleName",t)},expression:"downloadInfo.moduleName"}}),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-download"},on:{click:e.checkInfo}},[e._v("\n        生产代码\n      ")])],1),a("table-list",{attrs:{data:e.list,columns:e.columns,"row-key":e.idKey},on:{handleSortChange:e.handleSortChange,handleSelectionChange:e.handleSelectionChange}}),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:e.getList}})],1)])},i=[],o=a("f499"),l=a.n(o),r=(a("ac6a"),a("b0b4")),s=a("d225"),c=a("308d"),u=a("6bb5"),d=a("4e2b"),m=a("9ab4"),f=a("60a3"),p=a("0bfbe"),h=a("333d"),y=a("b32d");function b(){return Object(y["a"])({url:"/sys/generator/dbInfos",method:"get"})}function g(e){return Object(y["a"])({url:"/sys/generator/list",method:"get",params:e})}function v(e){return Object(y["a"])({url:"/sys/generator/datasource",method:"get",params:e})}function w(){return Object(y["a"])({url:"sys/generator/isInitDB",method:"get"})}var k=a("27cf"),C=function(){function e(){Object(s["a"])(this,e),this.jdbcUrl="",this.port="3306",this.database="",this.username="",this.password=""}return Object(r["a"])(e,null,[{key:"build",value:function(t){var a=new e;return a.jdbcUrl=t.jdbcUrl,a.port=t.port,a.database=t.database,a.username=t.username,a.password=t.password,a}}]),e}(),x=a("1162"),F=a("c119"),O=a("c0c7"),j=a("6ac5"),S=a("482f"),N=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.tableName="",e}return Object(d["a"])(t,e),t}(k["a"]),I=(x["a"],function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.isShowList=!0,e.listQuery=new N,e.list=[],e.newList=[],e.columns=[{label:"表名",key:"tableName"},{label:"Engine",key:"engine"},{label:"表备注",key:"tableComment"},{label:"创建时间",key:"createTime",width:150}],e.total=0,e.multipleSelection=[],e.idKey="tableName",e.configForm=new C,e.rules={jdbcUrl:[{required:!0,message:"请输入数据库ip地址",trigger:"blur"}],database:[{required:!0,message:"请输入数据库名称",trigger:"blur"}],username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},e.downloadInfo={},e}return Object(d["a"])(t,e),Object(r["a"])(t,[{key:"created",value:function(){this.getConfig()}},{key:"getList",value:function(){var e=this;g(this.listQuery).then(function(t){if(!t.page)return e.list=[],void(e.total=0);var a=t.page;e.list=a.list,e.total=a.totalCount,e.newList=e.list.map(function(t){return t[e.idKey]});var n=document.querySelectorAll(".el-table__body-wrapper > table > tbody")[0];Object(O["a"])(n,e.list,e.newList)})}},{key:"handleFilter",value:function(){this.listQuery._search=!0,this.listQuery.page=1,this.getList()}},{key:"handleSortChange",value:function(e){void 0!==e.sidx&&(this.listQuery.sidx=e.sidx),this.listQuery.order=e.order,this.handleFilter()}},{key:"handleSelectionChange",value:function(e){this.multipleSelection=e}},{key:"getMsgFromChild",value:function(e){"cancel"!==e&&this.handleFilter(),this.isShowList=!0}},{key:"getConfig",value:function(){var e=this;b().then(function(t){e.configForm=C.build(t.infos),e.getList()})}},{key:"getDatasource",value:function(){var e=this,t=this.$refs["ruleForm"];t.validate(function(t){if(!t)return console.log("error submit!!"),!1;v(e.configForm).then(function(t){e.getConfig()})})}},{key:"checkInfo",value:function(){var e=this;null!==this.configForm?this.downloadInfo.sysName&&this.downloadInfo.moduleName?Object(F["a"])(this.multipleSelection).then(function(){w().then(function(t){e.downloadFile()})}):this.$alert("请输入系统名和模块名"):this.$alert("请先初始化数据库")}},{key:"downloadFile",value:function(){console.log(this.multipleSelection);var e=[];this.multipleSelection.forEach(function(t){e.push(t.tableName)}),window.open(S["a"]+"/sys/generator/code?tables="+encodeURIComponent(encodeURIComponent(l()(e)))+"&sysName="+this.downloadInfo.sysName+"&moduleName="+this.downloadInfo.moduleName+"&token="+Object(j["a"])())}}]),t}(f["c"]));I=m["a"]([Object(f["a"])({name:"CodeGeneration",components:{TableList:p["a"],Pagination:h["a"]}})],I);var $=I,Q=$,_=a("2877"),L=Object(_["a"])(Q,n,i,!1,null,null,null);t["default"]=L.exports},a21f:function(e,t,a){var n=a("584a"),i=n.JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return i.stringify.apply(i,arguments)}},f499:function(e,t,a){e.exports=a("a21f")}}]);
//# sourceMappingURL=CodeGeneration.95ac5186.js.map